{"ast":null,"code":"var _jsxFileName = \"D:\\\\projects\\\\volume-monitor\\\\src\\\\components\\\\AudioTest.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { SideMenu } from './SideMenu';\nimport { SettingsPanel } from './SettingsPanel';\nimport { TestPanel } from './TestPanel';\nimport { VolumeVisualizer } from './VolumeVisualizer';\nimport { useAudioMonitor } from '../hooks/useAudioMonitor';\nimport { settingsManager } from '../utils/settingsManager';\nimport { alertManager } from '../utils/alertManager';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Container = styled.div`\n  margin-left: 240px;\n  padding: 20px;\n  max-width: 1200px;\n`;\n_c = Container;\nconst MainContent = styled.div`\n  padding: 20px;\n`;\n_c2 = MainContent;\nexport const AudioTest = () => {\n  _s();\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n  const [settings, setSettings] = useState(settingsManager.getSettings());\n  const [threshold, setThreshold] = useState(settings.threshold);\n  const [lowVolumeDuration, setLowVolumeDuration] = useState(settings.lowVolumeDuration);\n  const handleSettingsChange = useCallback(newSettings => {\n    const updatedSettings = {\n      ...settings,\n      ...newSettings\n    };\n    setSettings(updatedSettings);\n    settingsManager.updateSettings(updatedSettings);\n\n    // 更新相关状态\n    if (newSettings.threshold !== undefined) {\n      setThreshold(newSettings.threshold);\n    }\n    if (newSettings.lowVolumeDuration !== undefined) {\n      setLowVolumeDuration(newSettings.lowVolumeDuration);\n    }\n\n    // 更新 alertManager 的配置\n    alertManager.updateConfig({\n      textEnabled: updatedSettings.textAlerts,\n      soundEnabled: updatedSettings.soundAlerts,\n      threshold: updatedSettings.threshold,\n      minInterval: updatedSettings.alertInterval,\n      lowVolumeDuration: updatedSettings.lowVolumeDuration\n    });\n  }, [settings]);\n  const {\n    volume,\n    error,\n    startMonitoring\n  } = useAudioMonitor({\n    threshold,\n    onVolumeLow: useCallback(() => {\n      alertManager.trigger('low-volume');\n    }, [])\n  });\n  const handleTest = useCallback(type => {\n    switch (type) {\n      case 'visualAlert':\n        alertManager.trigger('visual');\n        break;\n      case 'textAlert':\n        alertManager.trigger('text');\n        break;\n      case 'soundAlert':\n        alertManager.trigger('sound');\n        break;\n      case 'allAlerts':\n        alertManager.trigger('all');\n        break;\n      // ... 其他测试类型\n    }\n  }, []);\n  useEffect(() => {\n    startMonitoring();\n  }, [startMonitoring]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SideMenu, {\n      onOpenSettings: () => setIsSettingsOpen(true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(MainContent, {\n        children: /*#__PURE__*/_jsxDEV(VolumeVisualizer, {\n          volume: volume,\n          threshold: threshold,\n          isCompact: settings.compactMode\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SettingsPanel, {\n      isOpen: isSettingsOpen,\n      onClose: () => setIsSettingsOpen(false),\n      settings: {\n        threshold,\n        lowVolumeDuration,\n        textAlerts: settings.textAlerts,\n        soundAlerts: settings.soundAlerts,\n        alertVolume: settings.alertVolume\n      },\n      onSettingsChange: handleSettingsChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TestPanel, {\n      onTest: handleTest,\n      currentVolume: volume,\n      threshold: threshold\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(AudioTest, \"UqwbEB57baui6xZ99wYqCXAwkXI=\", false, function () {\n  return [useAudioMonitor];\n});\n_c3 = AudioTest;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"MainContent\");\n$RefreshReg$(_c3, \"AudioTest\");","map":{"version":3,"names":["React","useState","useCallback","useEffect","styled","SideMenu","SettingsPanel","TestPanel","VolumeVisualizer","useAudioMonitor","settingsManager","alertManager","jsxDEV","_jsxDEV","Fragment","_Fragment","Container","div","_c","MainContent","_c2","AudioTest","_s","isSettingsOpen","setIsSettingsOpen","settings","setSettings","getSettings","threshold","setThreshold","lowVolumeDuration","setLowVolumeDuration","handleSettingsChange","newSettings","updatedSettings","updateSettings","undefined","updateConfig","textEnabled","textAlerts","soundEnabled","soundAlerts","minInterval","alertInterval","volume","error","startMonitoring","onVolumeLow","trigger","handleTest","type","children","onOpenSettings","fileName","_jsxFileName","lineNumber","columnNumber","isCompact","compactMode","isOpen","onClose","alertVolume","onSettingsChange","onTest","currentVolume","_c3","$RefreshReg$"],"sources":["D:/projects/volume-monitor/src/components/AudioTest.tsx"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { SideMenu } from './SideMenu';\r\nimport { SettingsPanel } from './SettingsPanel';\r\nimport { TestPanel } from './TestPanel';\r\nimport { VolumeVisualizer } from './VolumeVisualizer';\r\nimport { useAudioMonitor } from '../hooks/useAudioMonitor';\r\nimport { settingsManager } from '../utils/settingsManager';\r\nimport { alertManager } from '../utils/alertManager';\r\n\r\nconst Container = styled.div`\r\n  margin-left: 240px;\r\n  padding: 20px;\r\n  max-width: 1200px;\r\n`;\r\n\r\nconst MainContent = styled.div`\r\n  padding: 20px;\r\n`;\r\n\r\nexport const AudioTest: React.FC = () => {\r\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n  const [settings, setSettings] = useState(settingsManager.getSettings());\r\n  const [threshold, setThreshold] = useState(settings.threshold);\r\n  const [lowVolumeDuration, setLowVolumeDuration] = useState(settings.lowVolumeDuration);\r\n\r\n  const handleSettingsChange = useCallback((newSettings: Partial<typeof settings>) => {\r\n    const updatedSettings = { ...settings, ...newSettings };\r\n    setSettings(updatedSettings);\r\n    settingsManager.updateSettings(updatedSettings);\r\n\r\n    // 更新相关状态\r\n    if (newSettings.threshold !== undefined) {\r\n      setThreshold(newSettings.threshold);\r\n    }\r\n    if (newSettings.lowVolumeDuration !== undefined) {\r\n      setLowVolumeDuration(newSettings.lowVolumeDuration);\r\n    }\r\n\r\n    // 更新 alertManager 的配置\r\n    alertManager.updateConfig({\r\n      textEnabled: updatedSettings.textAlerts,\r\n      soundEnabled: updatedSettings.soundAlerts,\r\n      threshold: updatedSettings.threshold,\r\n      minInterval: updatedSettings.alertInterval,\r\n      lowVolumeDuration: updatedSettings.lowVolumeDuration\r\n    });\r\n  }, [settings]);\r\n\r\n  const { volume, error, startMonitoring } = useAudioMonitor({\r\n    threshold,\r\n    onVolumeLow: useCallback(() => {\r\n      alertManager.trigger('low-volume');\r\n    }, [])\r\n  });\r\n\r\n  const handleTest = useCallback((type: string) => {\r\n    switch (type) {\r\n      case 'visualAlert':\r\n        alertManager.trigger('visual');\r\n        break;\r\n      case 'textAlert':\r\n        alertManager.trigger('text');\r\n        break;\r\n      case 'soundAlert':\r\n        alertManager.trigger('sound');\r\n        break;\r\n      case 'allAlerts':\r\n        alertManager.trigger('all');\r\n        break;\r\n      // ... 其他测试类型\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    startMonitoring();\r\n  }, [startMonitoring]);\r\n\r\n  return (\r\n    <>\r\n      <SideMenu onOpenSettings={() => setIsSettingsOpen(true)} />\r\n      \r\n      <Container>\r\n        <MainContent>\r\n          <VolumeVisualizer\r\n            volume={volume}\r\n            threshold={threshold}\r\n            isCompact={settings.compactMode}\r\n          />\r\n        </MainContent>\r\n      </Container>\r\n      \r\n      <SettingsPanel\r\n        isOpen={isSettingsOpen}\r\n        onClose={() => setIsSettingsOpen(false)}\r\n        settings={{\r\n          threshold,\r\n          lowVolumeDuration,\r\n          textAlerts: settings.textAlerts,\r\n          soundAlerts: settings.soundAlerts,\r\n          alertVolume: settings.alertVolume\r\n        }}\r\n        onSettingsChange={handleSettingsChange}\r\n      />\r\n      \r\n      <TestPanel\r\n        onTest={handleTest}\r\n        currentVolume={volume}\r\n        threshold={threshold}\r\n      />\r\n    </>\r\n  );\r\n}; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,WAAW,EAAEC,SAAS,QAAQ,OAAO;AAC/D,OAAOC,MAAM,MAAM,mBAAmB;AACtC,SAASC,QAAQ,QAAQ,YAAY;AACrC,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,YAAY,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAErD,MAAMC,SAAS,GAAGZ,MAAM,CAACa,GAAG;AAC5B;AACA;AACA;AACA,CAAC;AAACC,EAAA,GAJIF,SAAS;AAMf,MAAMG,WAAW,GAAGf,MAAM,CAACa,GAAG;AAC9B;AACA,CAAC;AAACG,GAAA,GAFID,WAAW;AAIjB,OAAO,MAAME,SAAmB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACvC,MAAM,CAACC,cAAc,EAAEC,iBAAiB,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAACwB,QAAQ,EAAEC,WAAW,CAAC,GAAGzB,QAAQ,CAACS,eAAe,CAACiB,WAAW,CAAC,CAAC,CAAC;EACvE,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAG5B,QAAQ,CAACwB,QAAQ,CAACG,SAAS,CAAC;EAC9D,MAAM,CAACE,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG9B,QAAQ,CAACwB,QAAQ,CAACK,iBAAiB,CAAC;EAEtF,MAAME,oBAAoB,GAAG9B,WAAW,CAAE+B,WAAqC,IAAK;IAClF,MAAMC,eAAe,GAAG;MAAE,GAAGT,QAAQ;MAAE,GAAGQ;IAAY,CAAC;IACvDP,WAAW,CAACQ,eAAe,CAAC;IAC5BxB,eAAe,CAACyB,cAAc,CAACD,eAAe,CAAC;;IAE/C;IACA,IAAID,WAAW,CAACL,SAAS,KAAKQ,SAAS,EAAE;MACvCP,YAAY,CAACI,WAAW,CAACL,SAAS,CAAC;IACrC;IACA,IAAIK,WAAW,CAACH,iBAAiB,KAAKM,SAAS,EAAE;MAC/CL,oBAAoB,CAACE,WAAW,CAACH,iBAAiB,CAAC;IACrD;;IAEA;IACAnB,YAAY,CAAC0B,YAAY,CAAC;MACxBC,WAAW,EAAEJ,eAAe,CAACK,UAAU;MACvCC,YAAY,EAAEN,eAAe,CAACO,WAAW;MACzCb,SAAS,EAAEM,eAAe,CAACN,SAAS;MACpCc,WAAW,EAAER,eAAe,CAACS,aAAa;MAC1Cb,iBAAiB,EAAEI,eAAe,CAACJ;IACrC,CAAC,CAAC;EACJ,CAAC,EAAE,CAACL,QAAQ,CAAC,CAAC;EAEd,MAAM;IAAEmB,MAAM;IAAEC,KAAK;IAAEC;EAAgB,CAAC,GAAGrC,eAAe,CAAC;IACzDmB,SAAS;IACTmB,WAAW,EAAE7C,WAAW,CAAC,MAAM;MAC7BS,YAAY,CAACqC,OAAO,CAAC,YAAY,CAAC;IACpC,CAAC,EAAE,EAAE;EACP,CAAC,CAAC;EAEF,MAAMC,UAAU,GAAG/C,WAAW,CAAEgD,IAAY,IAAK;IAC/C,QAAQA,IAAI;MACV,KAAK,aAAa;QAChBvC,YAAY,CAACqC,OAAO,CAAC,QAAQ,CAAC;QAC9B;MACF,KAAK,WAAW;QACdrC,YAAY,CAACqC,OAAO,CAAC,MAAM,CAAC;QAC5B;MACF,KAAK,YAAY;QACfrC,YAAY,CAACqC,OAAO,CAAC,OAAO,CAAC;QAC7B;MACF,KAAK,WAAW;QACdrC,YAAY,CAACqC,OAAO,CAAC,KAAK,CAAC;QAC3B;MACF;IACF;EACF,CAAC,EAAE,EAAE,CAAC;EAEN7C,SAAS,CAAC,MAAM;IACd2C,eAAe,CAAC,CAAC;EACnB,CAAC,EAAE,CAACA,eAAe,CAAC,CAAC;EAErB,oBACEjC,OAAA,CAAAE,SAAA;IAAAoC,QAAA,gBACEtC,OAAA,CAACR,QAAQ;MAAC+C,cAAc,EAAEA,CAAA,KAAM5B,iBAAiB,CAAC,IAAI;IAAE;MAAA6B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAE3D3C,OAAA,CAACG,SAAS;MAAAmC,QAAA,eACRtC,OAAA,CAACM,WAAW;QAAAgC,QAAA,eACVtC,OAAA,CAACL,gBAAgB;UACfoC,MAAM,EAAEA,MAAO;UACfhB,SAAS,EAAEA,SAAU;UACrB6B,SAAS,EAAEhC,QAAQ,CAACiC;QAAY;UAAAL,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACjC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACS;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eAEZ3C,OAAA,CAACP,aAAa;MACZqD,MAAM,EAAEpC,cAAe;MACvBqC,OAAO,EAAEA,CAAA,KAAMpC,iBAAiB,CAAC,KAAK,CAAE;MACxCC,QAAQ,EAAE;QACRG,SAAS;QACTE,iBAAiB;QACjBS,UAAU,EAAEd,QAAQ,CAACc,UAAU;QAC/BE,WAAW,EAAEhB,QAAQ,CAACgB,WAAW;QACjCoB,WAAW,EAAEpC,QAAQ,CAACoC;MACxB,CAAE;MACFC,gBAAgB,EAAE9B;IAAqB;MAAAqB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxC,CAAC,eAEF3C,OAAA,CAACN,SAAS;MACRwD,MAAM,EAAEd,UAAW;MACnBe,aAAa,EAAEpB,MAAO;MACtBhB,SAAS,EAAEA;IAAU;MAAAyB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtB,CAAC;EAAA,eACF,CAAC;AAEP,CAAC;AAAClC,EAAA,CA5FWD,SAAmB;EAAA,QA6BaZ,eAAe;AAAA;AAAAwD,GAAA,GA7B/C5C,SAAmB;AAAA,IAAAH,EAAA,EAAAE,GAAA,EAAA6C,GAAA;AAAAC,YAAA,CAAAhD,EAAA;AAAAgD,YAAA,CAAA9C,GAAA;AAAA8C,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}